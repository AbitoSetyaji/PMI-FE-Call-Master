module.exports=[70025,a=>{"use strict";var b=a.i(72131),c=a.i(12794),d=a.i(18544),e=a.i(33791),f=a.i(42871),g=class extends e.Subscribable{#a;#b=void 0;#c;#d;constructor(a,b){super(),this.#a=a,this.setOptions(b),this.bindMethods(),this.#e()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){let b=this.options;this.options=this.#a.defaultMutationOptions(a),(0,f.shallowEqualObjects)(this.options,b)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#c,observer:this}),b?.mutationKey&&this.options.mutationKey&&(0,f.hashKey)(b.mutationKey)!==(0,f.hashKey)(this.options.mutationKey)?this.reset():this.#c?.state.status==="pending"&&this.#c.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#c?.removeObserver(this)}onMutationUpdate(a){this.#e(),this.#f(a)}getCurrentResult(){return this.#b}reset(){this.#c?.removeObserver(this),this.#c=void 0,this.#e(),this.#f()}mutate(a,b){return this.#d=b,this.#c?.removeObserver(this),this.#c=this.#a.getMutationCache().build(this.#a,this.options),this.#c.addObserver(this),this.#c.execute(a)}#e(){let a=this.#c?.state??(0,c.getDefaultState)();this.#b={...a,isPending:"pending"===a.status,isSuccess:"success"===a.status,isError:"error"===a.status,isIdle:"idle"===a.status,mutate:this.mutate,reset:this.reset}}#f(a){d.notifyManager.batch(()=>{if(this.#d&&this.hasListeners()){let b=this.#b.variables,c=this.#b.context,d={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};a?.type==="success"?(this.#d.onSuccess?.(a.data,b,c,d),this.#d.onSettled?.(a.data,null,b,c,d)):a?.type==="error"&&(this.#d.onError?.(a.error,b,c,d),this.#d.onSettled?.(void 0,a.error,b,c,d))}this.listeners.forEach(a=>{a(this.#b)})})}},h=a.i(37927);function i(a,c){let e=(0,h.useQueryClient)(c),[i]=b.useState(()=>new g(e,a));b.useEffect(()=>{i.setOptions(a)},[i,a]);let j=b.useSyncExternalStore(b.useCallback(a=>i.subscribe(d.notifyManager.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),k=b.useCallback((a,b)=>{i.mutate(a,b).catch(f.noop)},[i]);if(j.error&&(0,f.shouldThrowError)(i.options.throwOnError,[j.error]))throw j.error;return{...j,mutate:k,mutateAsync:j.mutate}}a.s(["useMutation",()=>i],70025)},210,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},88780,a=>{"use strict";a.s([],58425),a.i(58425);var b=a.i(29415),c=a.i(7399);a.s(["defaultErrorMap",()=>c.default,"getErrorMap",()=>b.getErrorMap,"setErrorMap",()=>b.setErrorMap],77662),a.i(77662);var d=a.i(85244);a.s([],65416),a.i(65416);var e=a.i(9197),f=a.i(99614),g=a.i(81440);a.s(["BRAND",()=>f.BRAND,"DIRTY",()=>d.DIRTY,"EMPTY_PATH",()=>d.EMPTY_PATH,"INVALID",()=>d.INVALID,"NEVER",()=>f.NEVER,"OK",()=>d.OK,"ParseStatus",()=>d.ParseStatus,"Schema",()=>f.Schema,"ZodAny",()=>f.ZodAny,"ZodArray",()=>f.ZodArray,"ZodBigInt",()=>f.ZodBigInt,"ZodBoolean",()=>f.ZodBoolean,"ZodBranded",()=>f.ZodBranded,"ZodCatch",()=>f.ZodCatch,"ZodDate",()=>f.ZodDate,"ZodDefault",()=>f.ZodDefault,"ZodDiscriminatedUnion",()=>f.ZodDiscriminatedUnion,"ZodEffects",()=>f.ZodEffects,"ZodEnum",()=>f.ZodEnum,"ZodError",()=>g.ZodError,"ZodFirstPartyTypeKind",()=>f.ZodFirstPartyTypeKind,"ZodFunction",()=>f.ZodFunction,"ZodIntersection",()=>f.ZodIntersection,"ZodIssueCode",()=>g.ZodIssueCode,"ZodLazy",()=>f.ZodLazy,"ZodLiteral",()=>f.ZodLiteral,"ZodMap",()=>f.ZodMap,"ZodNaN",()=>f.ZodNaN,"ZodNativeEnum",()=>f.ZodNativeEnum,"ZodNever",()=>f.ZodNever,"ZodNull",()=>f.ZodNull,"ZodNullable",()=>f.ZodNullable,"ZodNumber",()=>f.ZodNumber,"ZodObject",()=>f.ZodObject,"ZodOptional",()=>f.ZodOptional,"ZodParsedType",()=>e.ZodParsedType,"ZodPipeline",()=>f.ZodPipeline,"ZodPromise",()=>f.ZodPromise,"ZodReadonly",()=>f.ZodReadonly,"ZodRecord",()=>f.ZodRecord,"ZodSchema",()=>f.ZodSchema,"ZodSet",()=>f.ZodSet,"ZodString",()=>f.ZodString,"ZodSymbol",()=>f.ZodSymbol,"ZodTransformer",()=>f.ZodTransformer,"ZodTuple",()=>f.ZodTuple,"ZodType",()=>f.ZodType,"ZodUndefined",()=>f.ZodUndefined,"ZodUnion",()=>f.ZodUnion,"ZodUnknown",()=>f.ZodUnknown,"ZodVoid",()=>f.ZodVoid,"addIssueToContext",()=>d.addIssueToContext,"any",()=>f.any,"array",()=>f.array,"bigint",()=>f.bigint,"boolean",()=>f.boolean,"coerce",()=>f.coerce,"custom",()=>f.custom,"date",()=>f.date,"datetimeRegex",()=>f.datetimeRegex,"defaultErrorMap",()=>c.default,"discriminatedUnion",()=>f.discriminatedUnion,"effect",()=>f.effect,"enum",()=>f.enum,"function",()=>f.function,"getErrorMap",()=>b.getErrorMap,"getParsedType",()=>e.getParsedType,"instanceof",()=>f.instanceof,"intersection",()=>f.intersection,"isAborted",()=>d.isAborted,"isAsync",()=>d.isAsync,"isDirty",()=>d.isDirty,"isValid",()=>d.isValid,"late",()=>f.late,"lazy",()=>f.lazy,"literal",()=>f.literal,"makeIssue",()=>d.makeIssue,"map",()=>f.map,"nan",()=>f.nan,"nativeEnum",()=>f.nativeEnum,"never",()=>f.never,"null",()=>f.null,"nullable",()=>f.nullable,"number",()=>f.number,"object",()=>f.object,"objectUtil",()=>e.objectUtil,"oboolean",()=>f.oboolean,"onumber",()=>f.onumber,"optional",()=>f.optional,"ostring",()=>f.ostring,"pipeline",()=>f.pipeline,"preprocess",()=>f.preprocess,"promise",()=>f.promise,"quotelessJson",()=>g.quotelessJson,"record",()=>f.record,"set",()=>f.set,"setErrorMap",()=>b.setErrorMap,"strictObject",()=>f.strictObject,"string",()=>f.string,"symbol",()=>f.symbol,"transformer",()=>f.transformer,"tuple",()=>f.tuple,"undefined",()=>f.undefined,"union",()=>f.union,"unknown",()=>f.unknown,"util",()=>e.util,"void",()=>f.void],73950);var h=a.i(73950);a.s(["z",0,h],88780)},6664,a=>{"use strict";var b=a.i(87924),c=a.i(70025),d=a.i(37927),e=a.i(19032),f=a.i(23292),g=a.i(50944),h=a.i(210),i=a.i(95245),j=a.i(59501),k=a.i(88780),l=a.i(33217),m=a.i(72131);let n=k.z.object({report_id:k.z.string().min(1,"Report is required"),driver_id:k.z.string().min(1,"Driver is required")});function o({initialReportId:a,onSubmit:c,isSubmitting:d=!1}){let{register:f,handleSubmit:g,formState:{errors:h},control:k,setValue:o}=(0,i.useForm)({resolver:(0,j.zodResolver)(n),defaultValues:{report_id:a||"",driver_id:""}});(0,m.useEffect)(()=>{a&&o("report_id",a)},[a,o]);let{data:p,isLoading:q}=(0,l.useQuery)({queryKey:["reports",{status_filter:"pending"}],queryFn:()=>e.reportsApi.getAll(),staleTime:0,refetchInterval:5e3,refetchIntervalInBackground:!0}),{data:r,isLoading:s}=(0,l.useQuery)({queryKey:["users",{role:"driver"}],queryFn:()=>e.usersApi.getAll({role:"driver"}),staleTime:0,refetchInterval:1e4,refetchIntervalInBackground:!0}),t=(p||[]).filter(a=>"pending"===a.status),u=r||[],v=(0,i.useWatch)({control:k,name:"report_id"}),w=t.find(a=>a.id===v);return(0,b.jsxs)("form",{onSubmit:g(a=>{c(a)}),className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Report"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Pending Report ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),q?(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"Loading reports..."}):0===t.length?(0,b.jsx)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-yellow-800 text-sm",children:"No pending reports available. All reports have been assigned or completed."})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("select",{...f("report_id"),disabled:!!a,className:`w-full px-4 py-2 border ${h.report_id?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed`,children:[(0,b.jsx)("option",{value:"",children:"Select a report"}),t.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.requester_name," - ",a.patient_name," (",a.pickup_address,")"]},a.id))]}),h.report_id&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:h.report_id.message}),a&&(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"ℹ️ Report is pre-selected from previous page"}),w&&(0,b.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,b.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"Report Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-blue-800",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Requester:"})," ",w.requester_name]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Phone:"})," ",w.requester_phone]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Patient:"})," ",w.patient_name]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Age:"})," ",w.patient_age," years"]})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Pickup:"})," ",w.pickup_address]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Destination:"})," ",w.destination_address]})]}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Schedule:"})," ",w.schedule_date," at"," ",w.schedule_time]})}),w.note&&(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Note:"})," ",w.note]})})]})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Driver"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Driver ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),s?(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"Loading drivers..."}):0===u.length?(0,b.jsx)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-yellow-800 text-sm",children:"No drivers available in the system."})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("select",{...f("driver_id"),className:`w-full px-4 py-2 border ${h.driver_id?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent`,children:[(0,b.jsx)("option",{value:"",children:"Select a driver"}),u.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," - ",a.email]},a.id))]}),h.driver_id&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:h.driver_id.message})]})]})]}),(0,b.jsx)("div",{className:"flex gap-4",children:(0,b.jsx)("button",{type:"submit",disabled:d||0===t.length||0===u.length,className:"flex-1 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:d?"Creating Assignment...":"Create Assignment"})}),(0===t.length||0===u.length)&&(0,b.jsxs)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,b.jsx)("p",{className:"text-yellow-800 text-sm font-medium",children:"⚠️ Cannot create assignment: Missing required resources"}),(0,b.jsxs)("ul",{className:"mt-2 text-yellow-700 text-sm list-disc list-inside",children:[0===t.length&&(0,b.jsx)("li",{children:"No pending reports available"}),0===u.length&&(0,b.jsx)("li",{children:"No drivers in system"})]})]})]})}function p(){let a=(0,g.useRouter)(),i=(0,d.useQueryClient)(),j=(0,g.useSearchParams)().get("report_id"),k=(0,c.useMutation)({mutationFn:a=>e.assignmentsApi.create(a),onSuccess:b=>{i.invalidateQueries({queryKey:["assignments"]}),i.invalidateQueries({queryKey:["reports"]}),f.toast.success("Assignment created successfully"),a.push(`/dashboard/assignments/${b.id}`)},onError:a=>{f.toast.error(a?.response?.data?.detail||"Failed to create assignment")}});return(0,b.jsxs)("div",{className:"space-y-6 max-w-4xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:()=>a.back(),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(h.ArrowLeft,{className:"w-5 h-5 text-gray-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Create Assignment"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Assign a vehicle and driver to an emergency report"})]})]}),(0,b.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"How it works:"}),(0,b.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[(0,b.jsx)("li",{children:"Select a pending report that needs attention"}),(0,b.jsx)("li",{children:"Choose an available vehicle from the fleet"}),(0,b.jsx)("li",{children:"Assign a driver to handle the emergency"}),(0,b.jsx)("li",{children:"The assignment will be created and the driver notified"})]})]}),(0,b.jsx)(o,{initialReportId:j||void 0,onSubmit:a=>{k.mutate(a)},isSubmitting:k.isPending})]})}function q(){return(0,b.jsx)(m.Suspense,{fallback:(0,b.jsx)("div",{children:"Loading..."}),children:(0,b.jsx)(p,{})})}a.s(["default",()=>q],6664)}];

//# sourceMappingURL=_a1472379._.js.map