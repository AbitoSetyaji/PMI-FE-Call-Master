module.exports=[68114,a=>{"use strict";function b(...a){return function(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d}(a)}function c(a){return("string"==typeof a?new Date(a):a).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}a.s(["cn",()=>b,"formatDateTime",()=>c],68114)},55486,a=>{"use strict";var b=a.i(87924),c=a.i(68114);function d({children:a,variant:d="default",className:e}){let f={default:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800",pending:"bg-status-pending-bg text-yellow-800 border border-status-pending",active:"bg-blue-100 text-blue-800 border border-blue-300",assigned:"bg-status-assigned-bg text-blue-800 border border-status-assigned",on_progress:"bg-status-on-progress-bg text-orange-800 border border-status-on-progress",completed:"bg-status-completed-bg text-green-800 border border-status-completed",cancelled:"bg-status-cancelled-bg text-gray-800 border border-status-cancelled",low:"bg-gray-100 text-gray-700 border border-gray-300",medium:"bg-yellow-100 text-yellow-800 border border-yellow-400",high:"bg-orange-100 text-orange-800 border border-orange-400",urgent:"bg-red-100 text-red-800 border border-red-400",critical:"bg-red-100 text-red-800 border border-red-600 font-semibold",available:"bg-green-100 text-green-800 border border-green-400",on_duty:"bg-blue-100 text-blue-800 border border-blue-400",maintenance:"bg-gray-100 text-gray-700 border border-gray-400",admin:"bg-purple-100 text-purple-800 border border-purple-400",driver:"bg-blue-100 text-blue-800 border border-blue-400",reporter:"bg-green-100 text-green-800 border border-green-400"};return(0,b.jsx)("span",{className:(0,c.cn)("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors-smooth",f[d]||f.default,e),children:a})}a.s(["Badge",()=>d])},70025,a=>{"use strict";var b=a.i(72131),c=a.i(12794),d=a.i(18544),e=a.i(33791),f=a.i(42871),g=class extends e.Subscribable{#a;#b=void 0;#c;#d;constructor(a,b){super(),this.#a=a,this.setOptions(b),this.bindMethods(),this.#e()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){let b=this.options;this.options=this.#a.defaultMutationOptions(a),(0,f.shallowEqualObjects)(this.options,b)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#c,observer:this}),b?.mutationKey&&this.options.mutationKey&&(0,f.hashKey)(b.mutationKey)!==(0,f.hashKey)(this.options.mutationKey)?this.reset():this.#c?.state.status==="pending"&&this.#c.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#c?.removeObserver(this)}onMutationUpdate(a){this.#e(),this.#f(a)}getCurrentResult(){return this.#b}reset(){this.#c?.removeObserver(this),this.#c=void 0,this.#e(),this.#f()}mutate(a,b){return this.#d=b,this.#c?.removeObserver(this),this.#c=this.#a.getMutationCache().build(this.#a,this.options),this.#c.addObserver(this),this.#c.execute(a)}#e(){let a=this.#c?.state??(0,c.getDefaultState)();this.#b={...a,isPending:"pending"===a.status,isSuccess:"success"===a.status,isError:"error"===a.status,isIdle:"idle"===a.status,mutate:this.mutate,reset:this.reset}}#f(a){d.notifyManager.batch(()=>{if(this.#d&&this.hasListeners()){let b=this.#b.variables,c=this.#b.context,d={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};a?.type==="success"?(this.#d.onSuccess?.(a.data,b,c,d),this.#d.onSettled?.(a.data,null,b,c,d)):a?.type==="error"&&(this.#d.onError?.(a.error,b,c,d),this.#d.onSettled?.(void 0,a.error,b,c,d))}this.listeners.forEach(a=>{a(this.#b)})})}},h=a.i(37927);function i(a,c){let e=(0,h.useQueryClient)(c),[i]=b.useState(()=>new g(e,a));b.useEffect(()=>{i.setOptions(a)},[i,a]);let j=b.useSyncExternalStore(b.useCallback(a=>i.subscribe(d.notifyManager.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),k=b.useCallback((a,b)=>{i.mutate(a,b).catch(f.noop)},[i]);if(j.error&&(0,f.shouldThrowError)(i.options.throwOnError,[j.error]))throw j.error;return{...j,mutate:k,mutateAsync:j.mutate}}a.s(["useMutation",()=>i],70025)},210,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},63519,a=>{"use strict";let b=(0,a.i(70106).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);a.s(["Phone",()=>b],63519)},41675,a=>{"use strict";let b=(0,a.i(70106).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>b],41675)},50731,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33217),e=a.i(70025),f=a.i(37927),g=a.i(19032),h=a.i(55486),i=a.i(210),j=a.i(4720),k=a.i(10227),l=a.i(46842),m=a.i(41675),n=a.i(24987),o=a.i(63519),p=a.i(68114),q=a.i(32636),r=a.i(38246),s=a.i(50944),t=a.i(23292);function u({params:a}){let{id:u}=(0,c.use)(a),v=(0,s.useRouter)(),w=(0,f.useQueryClient)(),{user:x}=(0,q.useAuth)(),y=x?.role==="admin",z=x?.role==="driver",A=x?.role==="reporter",[B,C]=(0,c.useState)(!1),{data:D,isLoading:E,error:F}=(0,d.useQuery)({queryKey:["assignment",u],queryFn:()=>g.assignmentsApi.getById(u),staleTime:0,refetchInterval:5e3,refetchIntervalInBackground:!0}),{data:G,isLoading:H}=(0,d.useQuery)({queryKey:["report",D?.report_id],queryFn:()=>g.reportsApi.getById(D.report_id),enabled:!!D?.report_id,staleTime:0,refetchInterval:5e3,refetchIntervalInBackground:!0}),I=z&&x?.id===D?.driver_id,J=(0,e.useMutation)({mutationFn:a=>g.assignmentsApi.updateDriverAssignment(u,{status:a}),onSuccess:()=>{w.invalidateQueries({queryKey:["assignment",u]}),w.invalidateQueries({queryKey:["assignments"]}),w.invalidateQueries({queryKey:["driver-assignments"]}),t.toast.success("Assignment status updated successfully"),C(!1)},onError:a=>{t.toast.error(a?.response?.data?.detail||"Failed to update status"),C(!1)}});return E||H?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading assignment details..."})]})}):F||!D?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("p",{className:"text-red-600 mb-4",children:"Failed to load assignment details"}),(0,b.jsx)(r.default,{href:"/dashboard/assignments",className:"text-red-600 hover:text-red-700 font-medium",children:"← Back to Assignments"})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:()=>v.back(),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(i.ArrowLeft,{className:"w-5 h-5 text-gray-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Assignment Details"}),(0,b.jsxs)("p",{className:"text-gray-600 mt-1",children:["Assignment ID: ",D.id]})]})]})}),(0,b.jsx)("div",{children:(0,b.jsx)(h.Badge,{variant:D.status,children:D.status})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[G&&(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(j.FileText,{className:"w-5 h-5 text-red-600"}),"Report Information"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(l.User,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Requester"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:G.requester_name})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(o.Phone,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Phone"}),(0,b.jsx)("a",{href:`tel:${G.requester_phone}`,className:"font-medium text-red-600 hover:text-red-700",children:G.requester_phone})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(n.MapPin,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Patient"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:G.patient_name})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(n.MapPin,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Pickup Address"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:G.pickup_address})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(n.MapPin,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Destination"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:G.destination_address})]})]}),(0,b.jsx)("div",{className:"pt-3 border-t",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Status:"}),(0,b.jsx)(h.Badge,{variant:G.status,children:G.status})]})}),(0,b.jsx)(r.default,{href:`/dashboard/reports/${D.report_id}`,className:"inline-block mt-2 text-red-600 hover:text-red-700 font-medium text-sm",children:"View Full Report →"})]})]}),D.vehicle_id?D.vehicle?(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(k.Truck,{className:"w-5 h-5 text-red-600"}),"Vehicle Information"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Vehicle Name"}),(0,b.jsx)("p",{className:"font-medium text-gray-900 text-lg",children:D.vehicle.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Plate Number"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:D.vehicle.plate_number})]}),D.vehicle.vehicle_type&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Vehicle Type"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:D.vehicle.vehicle_type.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Status"}),(0,b.jsx)(h.Badge,{variant:D.vehicle.status,children:D.vehicle.status})]})]})]}):null:(0,b.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-yellow-900 mb-2 flex items-center gap-2",children:[(0,b.jsx)(k.Truck,{className:"w-5 h-5 text-yellow-600"}),"No Vehicle Assigned"]}),(0,b.jsx)("p",{className:"text-sm text-yellow-800",children:"This assignment does not have a vehicle assigned yet."})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(l.User,{className:"w-5 h-5 text-red-600"}),"Driver Information"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Name"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:D.driver_name||D.driver?.name||"Unknown"})]}),D.driver?.email&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:D.driver.email})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(m.Calendar,{className:"w-5 h-5 text-red-600"}),"Timeline"]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Assigned"}),(0,b.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:(0,p.formatDateTime)(D.assigned_at)})]}),D.completed_at&&(0,b.jsxs)("div",{className:"pt-3 border-t",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Completed"}),(0,b.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:(0,p.formatDateTime)(D.completed_at)})]})]})]}),(y||A||I)&&(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Update Status"}),(0,b.jsx)("div",{className:"space-y-2",children:["active","assigned","on_progress","completed","cancelled"].map(a=>!I||y||A||["on_progress","completed"].includes(a)?(0,b.jsxs)("button",{onClick:()=>{confirm(`Are you sure you want to change status to "${a}"?`)&&(C(!0),J.mutate(a))},disabled:D.status===a||B,className:`w-full px-4 py-2 rounded-lg text-sm font-medium transition-colors ${D.status===a?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-50 text-red-600 hover:bg-red-100"}`,children:[D.status===a?"Current: ":"Change to: ",a]},a):null)})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,b.jsx)("div",{className:"space-y-2",children:G&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.default,{href:`/dashboard/reports/${D.report_id}`,className:"block w-full px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-center text-sm font-medium",children:"View Report"}),G.requester_phone&&(0,b.jsx)("a",{href:`tel:${G.requester_phone}`,className:"block w-full px-4 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors text-center text-sm font-medium",children:"Call Requester"}),G.contact_person_phone&&(0,b.jsx)("a",{href:`tel:${G.contact_person_phone}`,className:"block w-full px-4 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors text-center text-sm font-medium",children:"Call Contact Person"})]})})]})]})]})]})}a.s(["default",()=>u])}];

//# sourceMappingURL=_cf9ada59._.js.map