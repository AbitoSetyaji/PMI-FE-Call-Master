module.exports=[6936,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33217),e=a.i(70025),f=a.i(37927),g=a.i(19032),h=a.i(55486),i=a.i(210),j=a.i(24987),k=a.i(63519),l=a.i(46842),m=a.i(41675),n=a.i(4720),o=a.i(24569),p=a.i(68114),q=a.i(32636),r=a.i(38246),s=a.i(50944),t=a.i(23292);function u({params:a}){let{id:u}=(0,c.use)(a),v=(0,s.useRouter)(),w=(0,f.useQueryClient)(),{user:x}=(0,q.useAuth)(),y=x?.role==="admin",z=x?.role==="reporter",[A,B]=(0,c.useState)(!1),{data:C,isLoading:D,error:E}=(0,d.useQuery)({queryKey:["report",u],queryFn:()=>g.reportsApi.getById(u)}),{data:F}=(0,d.useQuery)({queryKey:["assignments",{report_id:u}],queryFn:()=>g.assignmentsApi.getAll(),enabled:!!C}),G=F?.find(a=>a.report_id===u),H=(0,e.useMutation)({mutationFn:a=>g.reportsApi.updateReportStatus(u,{status:a}),onSuccess:()=>{w.invalidateQueries({queryKey:["report",u]}),w.invalidateQueries({queryKey:["reports"]}),t.toast.success("Report status updated successfully"),B(!1)},onError:a=>{t.toast.error(a?.response?.data?.detail||"Failed to update status"),B(!1)}});return D?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading report details..."})]})}):E||!C?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("p",{className:"text-red-600 mb-4",children:E?`Error: ${E instanceof Error?E.message:"Failed to load report details"}`:"Report not found"}),(0,b.jsx)(r.default,{href:"/dashboard/reports",className:"text-red-600 hover:text-red-700 font-medium",children:"â† Back to Reports"})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:()=>v.back(),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(i.ArrowLeft,{className:"w-5 h-5 text-gray-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Report Details"}),(0,b.jsxs)("p",{className:"text-gray-600 mt-1",children:["Report ID: ",C.id]})]})]}),(y||z)&&(0,b.jsxs)(r.default,{href:`/dashboard/reports/${u}/edit`,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[(0,b.jsx)(o.Edit,{className:"w-5 h-5"}),"Edit"]})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(h.Badge,{variant:C.status,children:C.status}),C.use_stretcher&&(0,b.jsx)(h.Badge,{variant:"info",children:"Coffin Required"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(l.User,{className:"w-5 h-5 text-red-600"}),"Requester Information"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(l.User,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Name"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.requester_name})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(k.Phone,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Phone Number"}),(0,b.jsx)("a",{href:`tel:${C.requester_phone}`,className:"font-medium text-red-600 hover:text-red-700",children:C.requester_phone})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(j.MapPin,{className:"w-5 h-5 text-red-600"}),"Transport Information"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Transport Type"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.transport_type_name?C.transport_type_name.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Coffin Required"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.use_stretcher?"âœ“ Yes":"âœ— No"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(l.User,{className:"w-5 h-5 text-red-600"}),"Patient Information"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Patient Name"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.patient_name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Gender"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:"male"===C.patient_gender?"â™‚ Male":"â™€ Female"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Age"}),(0,b.jsxs)("p",{className:"font-medium text-gray-900",children:[C.patient_age," years"]})]}),C.patient_history&&(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Medical History"}),(0,b.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:C.patient_history})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(j.MapPin,{className:"w-5 h-5 text-red-600"}),"Pickup & Destination"]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"ðŸ“ Pickup Address"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.pickup_address})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"ðŸ¥ Destination Address"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.destination_address})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(m.Calendar,{className:"w-5 h-5 text-red-600"}),"Schedule"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Date"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.schedule_date})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Time"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.schedule_time})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(k.Phone,{className:"w-5 h-5 text-red-600"}),"Contact Person"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(l.User,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Name"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:C.contact_person_name})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(k.Phone,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Phone Number"}),(0,b.jsx)("a",{href:`tel:${C.contact_person_phone}`,className:"font-medium text-red-600 hover:text-red-700",children:C.contact_person_phone})]})]})]})]}),(C.note||C.attachment_ktp||C.attachment_house_photo||C.attachment_sharelok)&&(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(n.FileText,{className:"w-5 h-5 text-red-600"}),"Additional Information"]}),(0,b.jsxs)("div",{className:"space-y-4",children:[C.note&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Note"}),(0,b.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:C.note})]}),(C.attachment_ktp||C.attachment_house_photo||C.attachment_sharelok)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Attachments"}),(0,b.jsxs)("div",{className:"space-y-2",children:[C.attachment_ktp&&(0,b.jsx)("a",{href:C.attachment_ktp,target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm",children:"ðŸ“„ KTP Attachment"}),C.attachment_house_photo&&(0,b.jsx)("a",{href:C.attachment_house_photo,target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm",children:"ðŸ  House Photo"}),C.attachment_sharelok&&(0,b.jsx)("a",{href:C.attachment_sharelok,target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm",children:"ðŸ“ Share Location"})]})]})]})]}),G&&(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Assignment Details"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Vehicle"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:G?.vehicle_plate||G?.vehicle?.plate_number||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Driver"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:G?.driver_name||G?.driver?.name||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Assignment Status"}),(0,b.jsx)(h.Badge,{variant:G.status,children:G.status})]}),(0,b.jsx)(r.default,{href:`/dashboard/assignments/${G.id}`,className:"inline-block mt-2 text-red-600 hover:text-red-700 font-medium text-sm",children:"View Full Assignment â†’"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(m.Calendar,{className:"w-5 h-5 text-red-600"}),"Timeline"]}),(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-600",children:"Created"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:(0,p.formatDateTime)(C.created_at)})]}),C.updated_at&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-600",children:"Last Updated"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:(0,p.formatDateTime)(C.updated_at)})]})]})]}),(y||z)&&(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Update Status"}),(0,b.jsx)("div",{className:"space-y-2",children:["pending","assigned","on_progress","completed","cancelled"].map(a=>(0,b.jsxs)("button",{onClick:()=>{confirm(`Are you sure you want to change status to "${a}"?`)&&(B(!0),H.mutate(a))},disabled:C.status===a||A,className:`w-full px-4 py-2 rounded-lg text-sm font-medium transition-colors ${C.status===a?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-50 text-red-600 hover:bg-red-100"}`,children:[C.status===a?"Current: ":"Change to: ",a]},a))})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,b.jsxs)("div",{className:"space-y-2",children:[!G&&"pending"===C.status&&(0,b.jsx)(r.default,{href:`/dashboard/assignments/create?report_id=${u}`,className:"block w-full px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-center text-sm font-medium",children:"Create Assignment"}),(0,b.jsx)("a",{href:`tel:${C.requester_phone}`,className:"block w-full px-4 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors text-center text-sm font-medium",children:"Call Requester"}),(0,b.jsx)("a",{href:`tel:${C.contact_person_phone}`,className:"block w-full px-4 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors text-center text-sm font-medium",children:"Call Contact Person"})]})]})]})]})]})}a.s(["default",()=>u])}];

//# sourceMappingURL=src_app_dashboard_reports_%5Bid%5D_page_tsx_56131c99._.js.map