module.exports=[70025,a=>{"use strict";var b=a.i(72131),c=a.i(12794),d=a.i(18544),e=a.i(33791),f=a.i(42871),g=class extends e.Subscribable{#a;#b=void 0;#c;#d;constructor(a,b){super(),this.#a=a,this.setOptions(b),this.bindMethods(),this.#e()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){let b=this.options;this.options=this.#a.defaultMutationOptions(a),(0,f.shallowEqualObjects)(this.options,b)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#c,observer:this}),b?.mutationKey&&this.options.mutationKey&&(0,f.hashKey)(b.mutationKey)!==(0,f.hashKey)(this.options.mutationKey)?this.reset():this.#c?.state.status==="pending"&&this.#c.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#c?.removeObserver(this)}onMutationUpdate(a){this.#e(),this.#f(a)}getCurrentResult(){return this.#b}reset(){this.#c?.removeObserver(this),this.#c=void 0,this.#e(),this.#f()}mutate(a,b){return this.#d=b,this.#c?.removeObserver(this),this.#c=this.#a.getMutationCache().build(this.#a,this.options),this.#c.addObserver(this),this.#c.execute(a)}#e(){let a=this.#c?.state??(0,c.getDefaultState)();this.#b={...a,isPending:"pending"===a.status,isSuccess:"success"===a.status,isError:"error"===a.status,isIdle:"idle"===a.status,mutate:this.mutate,reset:this.reset}}#f(a){d.notifyManager.batch(()=>{if(this.#d&&this.hasListeners()){let b=this.#b.variables,c=this.#b.context,d={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};a?.type==="success"?(this.#d.onSuccess?.(a.data,b,c,d),this.#d.onSettled?.(a.data,null,b,c,d)):a?.type==="error"&&(this.#d.onError?.(a.error,b,c,d),this.#d.onSettled?.(void 0,a.error,b,c,d))}this.listeners.forEach(a=>{a(this.#b)})})}},h=a.i(37927);function i(a,c){let e=(0,h.useQueryClient)(c),[i]=b.useState(()=>new g(e,a));b.useEffect(()=>{i.setOptions(a)},[i,a]);let j=b.useSyncExternalStore(b.useCallback(a=>i.subscribe(d.notifyManager.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),k=b.useCallback((a,b)=>{i.mutate(a,b).catch(f.noop)},[i]);if(j.error&&(0,f.shouldThrowError)(i.options.throwOnError,[j.error]))throw j.error;return{...j,mutate:k,mutateAsync:j.mutate}}a.s(["useMutation",()=>i],70025)},210,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},45980,a=>{"use strict";var b=a.i(87924),c=a.i(70025),d=a.i(37927),e=a.i(33217),f=a.i(19032),g=a.i(50944),h=a.i(23292),i=a.i(210),j=a.i(38246),k=a.i(72131);function l(){let a=(0,g.useRouter)(),l=(0,g.useSearchParams)(),m=(0,d.useQueryClient)(),n=l.get("report_id"),[o,p]=(0,k.useState)(n||""),[q,r]=(0,k.useState)(""),{data:s=[],isLoading:t}=(0,e.useQuery)({queryKey:["reports"],queryFn:()=>f.reportsApi.getAll()}),u=s.filter(a=>"pending"===a.status),{data:v,isLoading:w}=(0,e.useQuery)({queryKey:["users",{role:"driver"}],queryFn:()=>f.usersApi.getAll({role:"driver"})}),x=v||[];(0,k.useEffect)(()=>{n&&p(n)},[n]);let y=(0,c.useMutation)({mutationFn:a=>f.assignmentsApi.create(a),onSuccess:()=>{m.invalidateQueries({queryKey:["assignments"]}),m.invalidateQueries({queryKey:["reports"]}),h.toast.success("Assignment created successfully"),a.push("/dashboard/assignments")},onError:a=>{h.toast.error(a.message||"Failed to create assignment")}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(j.default,{href:"/dashboard/assignments",className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(i.ArrowLeft,{className:"w-5 h-5 text-gray-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Create New Assignment"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Assign a driver to a pending report"})]})]}),(0,b.jsxs)("form",{onSubmit:a=>{(a.preventDefault(),o)?q?y.mutate({report_id:o,driver_id:q}):h.toast.error("Please select a driver"):h.toast.error("Please select a report")},className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"report_id",className:"block text-sm font-medium text-gray-700 mb-2",children:["Report ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),t?(0,b.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg bg-gray-50",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Loading reports..."})]}):(0,b.jsxs)("select",{id:"report_id",value:o,onChange:a=>p(a.target.value),disabled:y.isPending,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",children:[(0,b.jsx)("option",{value:"",children:"Select a report"}),u.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.requester_name," - ",a.patient_name," (",a.schedule_date,")"]},a.id))]}),0===u.length&&!t&&(0,b.jsx)("p",{className:"text-sm text-yellow-600 mt-1",children:"No pending reports available for assignment."})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"driver_id",className:"block text-sm font-medium text-gray-700 mb-2",children:["Driver ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),w?(0,b.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg bg-gray-50",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Loading drivers..."})]}):(0,b.jsxs)("select",{id:"driver_id",value:q,onChange:a=>r(a.target.value),disabled:y.isPending,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",children:[(0,b.jsx)("option",{value:"",children:"Select a driver"}),x.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.email,")"]},a.id))]}),0===x.length&&!w&&(0,b.jsx)("p",{className:"text-sm text-yellow-600 mt-1",children:"No drivers available."})]})]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("button",{type:"submit",disabled:y.isPending||!o||!q,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y.isPending?(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):"Create Assignment"}),(0,b.jsx)(j.default,{href:"/dashboard/assignments",className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}function m(){return(0,b.jsx)(k.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}),children:(0,b.jsx)(l,{})})}a.s(["default",()=>m])}];

//# sourceMappingURL=_ec438c1d._.js.map